<!DOCTYPE html>
<html>
<head>
  <title>Server Error (500)</title>
  <style>
    .error-box {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f8f8f8;
      border-radius: 8px;
      margin: 40px auto;
      width: 600px;
    }
    code { background: #eee; padding: 4px; }
  </style>
</head>
<body>
  <div class="error-box">
    <h2>We're experiencing some technical issues.</h2>
    <p>Please try again later.</p>
    <p><strong>Cloudflare Diagnostics:</strong></p>
    <p>Ray ID: <code id="cf-ray">Fetching...</code></p>
    <p>Request ID: <code id="cf-request-id">Fetching...</code></p>
  </div>

  <script>
    document.getElementById("cf-ray").textContent =
      getHeader("CF-Ray") || "Unavailable";
    document.getElementById("cf-request-id").textContent =
      getHeader("CF-Request-ID") || "Unavailable";

    // Helper to retrieve header values from request using Cloudflare Workers environment
    async function getHeader(name) {
      const response = await fetch(window.location.href, { method: 'HEAD' });
      return response.headers.get(name);
    }

    // Immediately invoke and set headers
    (async () => {
      document.getElementById("cf-ray").textContent = await getHeader("CF-Ray") || "Unavailable";
      document.getElementById("cf-request-id").textContent = await getHeader("CF-Request-ID") || "Unavailable";
    })();
  </script>
</body>
</html>